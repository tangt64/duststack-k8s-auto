- name: set to an IP Address for {{ inventory_hostname }}
  nmcli:
    type: "{{ item.type }}"
    conn_name: "{{ item.conn_name }}"
    ifname: "{{ item.ifname }}"
    ip4: "{{ item.ip4 }}{{ item.ip4_cidr }}"
    gw4: "{{ item.gw4 }}"
    state: present
    autoconnect: "{{ item.autocon }}"
#    gw4_ignore: "{{ item.gw4_no_default }}"
  with_items:
    - "{{ nmcli_ethernet }}"

- name: deactive and active to the kubernetes internal interface
  block:
    - command: nmcli con mod {{ k8s_interface }} ipv4.method manual
    - command: nmcli con down {{ k8s_interface }}
    - command: nmcli con up {{ k8s_interface }}

- name: add the kubernetes internal interface to firewalld
  firewalld:
    interface: "{{ k8s_interface }}"
    permanent: yes
    state: enabled
    zone: public

- name: set to a hostname
  hostname:
    name: "{{ nodename }}"
- name: set to a /etc/hosts file
  template:
    src: hosts.j2
    dest: /etc/hosts